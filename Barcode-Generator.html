<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Generator - Create Professional Barcodes Instantly</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }

        .input-section {
            padding: 40px;
            background: #f8faff;
            border-right: 1px solid #e9ecef;
        }

        .output-section {
            padding: 40px;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .section-title {
            color: #007bff;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 25px;
            text-align: center;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-label {
            display: block;
            color: #495057;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .text-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1.2rem;
            outline: none;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        .text-input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .input-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .input-select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .size-control {
            display: flex;
            flex-direction: column;
        }

        .range-input {
            width: 100%;
            margin: 10px 0;
            accent-color: #007bff;
        }

        .range-display {
            text-align: center;
            color: #007bff;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .color-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .color-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .color-input {
            width: 60px;
            height: 40px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 8px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #0056b3, #004085);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #1e7e34, #155724);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #545b62);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #545b62, #495057);
        }

        .barcode-display {
            background: white;
            border: 3px solid #e9ecef;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            width: 100%;
            transition: all 0.3s ease;
            overflow-x: auto;
        }

        .barcode-display.has-barcode {
            border-color: #007bff;
            box-shadow: 0 10px 25px rgba(0, 123, 255, 0.1);
        }

        .barcode-placeholder {
            text-align: center;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .barcode-placeholder .icon {
            font-size: 4rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .barcode-info {
            background: #f8faff;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            width: 100%;
        }

        .encoded-text {
            background: #e7f3ff;
            border: 2px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            word-break: break-all;
            text-align: center;
        }

        .encoded-label {
            font-weight: 600;
            color: #0056b3;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .encoded-content {
            color: #495057;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .barcode-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .stat-item {
            text-align: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1rem;
            font-weight: 600;
            color: #007bff;
        }

        .templates-section {
            margin-bottom: 25px;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .template-btn {
            padding: 10px 12px;
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-size: 0.85rem;
            color: #0056b3;
            transition: all 0.3s ease;
        }

        .template-btn:hover {
            background: #007bff;
            color: white;
        }

        .download-section {
            width: 100%;
        }

        .download-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .download-btn {
            padding: 12px;
            background: #f8faff;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .download-btn:hover {
            border-color: #007bff;
            background: white;
            color: #007bff;
            transform: translateY(-2px);
        }

        .format-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .format-btn {
            padding: 8px;
            background: #f1f3f4;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-size: 0.8rem;
            color: #495057;
            transition: all 0.3s ease;
        }

        .format-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .validation-message {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            display: none;
        }

        .validation-message.show {
            display: block;
        }

        .hidden {
            display: none !important;
        }

        .notification {
            padding: 12px 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            font-weight: 600;
            display: none;
        }

        .notification.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .notification.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .input-section,
            .output-section {
                padding: 25px;
            }

            .controls-grid {
                grid-template-columns: 1fr;
            }

            .color-controls {
                grid-template-columns: 1fr;
            }

            .barcode-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .download-grid {
                grid-template-columns: 1fr;
            }

            .templates-grid {
                grid-template-columns: 1fr;
            }

            .format-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .input-section,
            .output-section {
                padding: 20px;
            }

            .barcode-stats {
                grid-template-columns: 1fr;
            }

            .format-options {
                grid-template-columns: 1fr;
            }
        }

        #barcodeCanvas {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 Barcode Generator</h1>
            <p>Create professional, scannable barcodes instantly for any text or number</p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">⚙️ Create Barcode</h2>

                <div class="input-group">
                    <label class="input-label">Enter text or numbers to encode:</label>
                    <input 
                        type="text" 
                        class="text-input" 
                        id="barcodeText" 
                        placeholder="Enter text or numbers..."
                        value="123456789012"
                    >
                </div>

                <div class="validation-message" id="validationMessage"></div>

                <div class="templates-section">
                    <label class="input-label">Quick Templates:</label>
                    <div class="templates-grid">
                        <button class="template-btn" onclick="setTemplate('product')">🛍️ Product Code</button>
                        <button class="template-btn" onclick="setTemplate('isbn')">📚 ISBN</button>
                        <button class="template-btn" onclick="setTemplate('code128')">🔤 Text Code</button>
                        <button class="template-btn" onclick="setTemplate('serial')">🔢 Serial Number</button>
                    </div>
                </div>

                <div class="controls-grid">
                    <div class="input-group">
                        <label class="input-label">Barcode Type:</label>
                        <select class="input-select" id="barcodeType">
                            <option value="CODE128">Code 128 (Universal)</option>
                            <option value="EAN13">EAN-13 (Product)</option>
                            <option value="EAN8">EAN-8 (Small Product)</option>
                            <option value="UPC">UPC-A (US Product)</option>
                            <option value="CODE39">Code 39 (Alpha-Numeric)</option>
                            <option value="ITF14">ITF-14 (Shipping)</option>
                            <option value="MSI">MSI (Inventory)</option>
                            <option value="pharmacode">Pharmacode (Medicine)</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Width Scale:</label>
                        <div class="size-control">
                            <input type="range" class="range-input" id="barcodeWidth" min="1" max="4" step="0.5" value="2">
                            <div class="range-display" id="widthDisplay">2x</div>
                        </div>
                    </div>
                </div>

                <div class="controls-grid">
                    <div class="input-group">
                        <label class="input-label">Height:</label>
                        <div class="size-control">
                            <input type="range" class="range-input" id="barcodeHeight" min="50" max="200" value="100">
                            <div class="range-display" id="heightDisplay">100px</div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Show Text:</label>
                        <select class="input-select" id="showText">
                            <option value="true">Yes - Show text below</option>
                            <option value="false">No - Barcode only</option>
                        </select>
                    </div>
                </div>

                <div class="color-controls">
                    <div class="color-group">
                        <label class="input-label">Bar Color:</label>
                        <input type="color" class="color-input" id="barColor" value="#000000">
                    </div>
                    <div class="color-group">
                        <label class="input-label">Background:</label>
                        <input type="color" class="color-input" id="bgColor" value="#ffffff">
                    </div>
                </div>

                <button class="btn btn-primary" onclick="generateBarcode()">
                    🔄 Generate Barcode
                </button>

                <button class="btn btn-secondary" onclick="clearAll()">
                    🗑️ Clear
                </button>

                <div class="notification" id="notification"></div>
            </div>

            <div class="output-section">
                <h2 class="section-title">📊 Your Barcode</h2>

                <div class="barcode-display" id="barcodeDisplay">
                    <div class="barcode-placeholder" id="barcodePlaceholder">
                        <div class="icon">📊</div>
                        <p><strong>Barcode will appear here</strong></p>
                        <p style="font-size: 0.9rem; margin-top: 10px; opacity: 0.7;">Enter text and click generate</p>
                    </div>
                    <svg id="barcodeCanvas" class="hidden"></svg>
                </div>

                <div class="barcode-info hidden" id="barcodeInfo">
                    <div class="encoded-text">
                        <div class="encoded-label">📝 Encoded Data:</div>
                        <div class="encoded-content" id="encodedData"></div>
                    </div>
                    
                    <div class="barcode-stats">
                        <div class="stat-item">
                            <div class="stat-label">Type</div>
                            <div class="stat-value" id="typeDisplay">CODE128</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Length</div>
                            <div class="stat-value" id="lengthDisplay">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Format</div>
                            <div class="stat-value" id="formatDisplay">SVG</div>
                        </div>
                    </div>
                </div>

                <div class="download-section hidden" id="downloadSection">
                    <h3 style="text-align: center; margin-bottom: 15px; color: #495057;">💾 Download Options</h3>
                    
                    <div class="format-options">
                        <button class="format-btn active" onclick="setDownloadFormat('png')" id="pngBtn">PNG</button>
                        <button class="format-btn" onclick="setDownloadFormat('svg')" id="svgBtn">SVG</button>
                        <button class="format-btn" onclick="setDownloadFormat('jpg')" id="jpgBtn">JPG</button>
                    </div>

                    <div class="download-grid">
                        <button class="download-btn" onclick="downloadBarcode(300, 150)">Small (300×150)</button>
                        <button class="download-btn" onclick="downloadBarcode(600, 300)">Medium (600×300)</button>
                        <button class="download-btn" onclick="downloadBarcode(1200, 600)">Large (1200×600)</button>
                        <button class="download-btn" onclick="downloadBarcode(2400, 1200)">Extra Large (2400×1200)</button>
                    </div>

                    <button class="btn btn-success" onclick="downloadCurrentBarcode()">
                        💾 Download Current Size
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JsBarcode Library - Professional Barcode Generator -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>

    <script>
        class BarcodeGenerator {
            constructor() {
                this.currentFormat = 'png';
                this.setupEventListeners();
                this.updateDisplays();
                
                // Generate initial barcode
                setTimeout(() => {
                    this.generateBarcode();
                }, 500);
            }

            setupEventListeners() {
                const textInput = document.getElementById('barcodeText');
                const typeSelect = document.getElementById('barcodeType');
                const widthInput = document.getElementById('barcodeWidth');
                const heightInput = document.getElementById('barcodeHeight');
                const showTextSelect = document.getElementById('showText');
                const barColor = document.getElementById('barColor');
                const bgColor = document.getElementById('bgColor');

                // Real-time generation
                textInput.addEventListener('input', () => {
                    this.validateAndGenerate();
                });

                typeSelect.addEventListener('change', () => {
                    this.validateAndGenerate();
                });

                widthInput.addEventListener('input', () => {
                    this.updateDisplays();
                    this.generateBarcode();
                });

                heightInput.addEventListener('input', () => {
                    this.updateDisplays();
                    this.generateBarcode();
                });

                showTextSelect.addEventListener('change', () => {
                    this.generateBarcode();
                });

                barColor.addEventListener('change', () => {
                    this.generateBarcode();
                });

                bgColor.addEventListener('change', () => {
                    this.generateBarcode();
                });
            }

            updateDisplays() {
                const width = document.getElementById('barcodeWidth').value;
                const height = document.getElementById('barcodeHeight').value;
                
                document.getElementById('widthDisplay').textContent = `${width}x`;
                document.getElementById('heightDisplay').textContent = `${height}px`;
            }

            validateAndGenerate() {
                const text = document.getElementById('barcodeText').value.trim();
                const type = document.getElementById('barcodeType').value;
                
                if (!text) {
                    this.hideBarcode();
                    return;
                }

                // Validate input based on barcode type
                const validation = this.validateInput(text, type);
                
                if (!validation.valid) {
                    this.showValidation(validation.message);
                    this.hideBarcode();
                    return;
                }

                this.hideValidation();
                this.generateBarcode();
            }

            validateInput(text, type) {
                switch (type) {
                    case 'EAN13':
                        if (!/^\d{12,13}$/.test(text)) {
                            return { valid: false, message: 'EAN-13 requires 12-13 digits only' };
                        }
                        break;
                    case 'EAN8':
                        if (!/^\d{7,8}$/.test(text)) {
                            return { valid: false, message: 'EAN-8 requires 7-8 digits only' };
                        }
                        break;
                    case 'UPC':
                        if (!/^\d{11,12}$/.test(text)) {
                            return { valid: false, message: 'UPC-A requires 11-12 digits only' };
                        }
                        break;
                    case 'CODE39':
                        if (!/^[A-Z0-9\-. $/+%]+$/.test(text)) {
                            return { valid: false, message: 'Code 39 supports: A-Z, 0-9, and -. $/+%' };
                        }
                        break;
                    case 'ITF14':
                        if (!/^\d{13,14}$/.test(text)) {
                            return { valid: false, message: 'ITF-14 requires 13-14 digits only' };
                        }
                        break;
                    case 'pharmacode':
                        if (!/^\d{1,6}$/.test(text) || parseInt(text) < 3 || parseInt(text) > 131070) {
                            return { valid: false, message: 'Pharmacode: 1-6 digits, value 3-131070' };
                        }
                        break;
                }
                
                return { valid: true };
            }

            showValidation(message) {
                const validationElement = document.getElementById('validationMessage');
                validationElement.textContent = message;
                validationElement.classList.add('show');
            }

            hideValidation() {
                document.getElementById('validationMessage').classList.remove('show');
            }

            generateBarcode() {
                const text = document.getElementById('barcodeText').value.trim();
                const type = document.getElementById('barcodeType').value;
                const width = parseFloat(document.getElementById('barcodeWidth').value);
                const height = parseInt(document.getElementById('barcodeHeight').value);
                const showText = document.getElementById('showText').value === 'true';
                const barColor = document.getElementById('barColor').value;
                const bgColor = document.getElementById('bgColor').value;

                if (!text) {
                    this.hideBarcode();
                    return;
                }

                try {
                    const canvas = document.getElementById('barcodeCanvas');
                    
                    // Generate barcode using JsBarcode
                    JsBarcode(canvas, text, {
                        format: type,
                        width: width,
                        height: height,
                        displayValue: showText,
                        lineColor: barColor,
                        background: bgColor,
                        margin: 10,
                        fontSize: 14,
                        textAlign: "center",
                        textPosition: "bottom",
                        textMargin: 5
                    });

                    this.showBarcode();
                    this.updateInfo(text, type);
                    this.showNotification('Barcode generated successfully!', 'success');

                } catch (error) {
                    this.showNotification('Error: ' + error.message, 'error');
                    this.hideBarcode();
                    console.error('Barcode Generation Error:', error);
                }
            }

            showBarcode() {
                document.getElementById('barcodePlaceholder').classList.add('hidden');
                document.getElementById('barcodeCanvas').classList.remove('hidden');
                document.getElementById('barcodeInfo').classList.remove('hidden');
                document.getElementById('downloadSection').classList.remove('hidden');
                document.getElementById('barcodeDisplay').classList.add('has-barcode');
            }

            hideBarcode() {
                document.getElementById('barcodePlaceholder').classList.remove('hidden');
                document.getElementById('barcodeCanvas').classList.add('hidden');
                document.getElementById('barcodeInfo').classList.add('hidden');
                document.getElementById('downloadSection').classList.add('hidden');
                document.getElementById('barcodeDisplay').classList.remove('has-barcode');
            }

            updateInfo(text, type) {
                document.getElementById('encodedData').textContent = text;
                document.getElementById('typeDisplay').textContent = type;
                document.getElementById('lengthDisplay').textContent = text.length;
                document.getElementById('formatDisplay').textContent = this.currentFormat.toUpperCase();
            }

            setTemplate(template) {
                const textInput = document.getElementById('barcodeText');
                const typeSelect = document.getElementById('barcodeType');
                
                const templates = {
                    product: {
                        text: '1234567890123',
                        type: 'EAN13'
                    },
                    isbn: {
                        text: '9781234567890',
                        type: 'EAN13'
                    },
                    code128: {
                        text: 'HELLO123',
                        type: 'CODE128'
                    },
                    serial: {
                        text: 'SN123456789',
                        type: 'CODE128'
                    }
                };

                if (templates[template]) {
                    textInput.value = templates[template].text;
                    typeSelect.value = templates[template].type;
                    this.generateBarcode();
                }
            }

            setDownloadFormat(format) {
                this.currentFormat = format;
                
                // Update button states
                document.querySelectorAll('.format-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(format + 'Btn').classList.add('active');
                
                // Update display
                document.getElementById('formatDisplay').textContent = format.toUpperCase();
            }

            downloadBarcode(width, height) {
                const text = document.getElementById('barcodeText').value.trim();
                const type = document.getElementById('barcodeType').value;
                const showText = document.getElementById('showText').value === 'true';
                const barColor = document.getElementById('barColor').value;
                const bgColor = document.getElementById('bgColor').value;
                
                if (!text) {
                    this.showNotification('Please generate a barcode first', 'error');
                    return;
                }

                try {
                    if (this.currentFormat === 'svg') {
                        this.downloadSVG(text, type, width, height, showText, barColor, bgColor);
                    } else {
                        this.downloadRaster(text, type, width, height, showText, barColor, bgColor);
                    }
                } catch (error) {
                    this.showNotification('Download failed: ' + error.message, 'error');
                    console.error('Download Error:', error);
                }
            }

            downloadSVG(text, type, width, height, showText, barColor, bgColor) {
                // Create temporary SVG element
                const tempSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                
                JsBarcode(tempSvg, text, {
                    format: type,
                    width: 2,
                    height: height,
                    displayValue: showText,
                    lineColor: barColor,
                    background: bgColor,
                    margin: 10,
                    fontSize: 14
                });

                // Download SVG
                const svgData = new XMLSerializer().serializeToString(tempSvg);
                const svgBlob = new Blob([svgData], { type: 'image/svg+xml' });
                const url = URL.createObjectURL(svgBlob);
                
                const link = document.createElement('a');
                link.download = `barcode_${width}x${height}.svg`;
                link.href = url;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                this.showNotification(`SVG barcode downloaded (${width}×${height})!`, 'success');
            }

            downloadRaster(text, type, width, height, showText, barColor, bgColor) {
                // Create temporary canvas
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = width;
                tempCanvas.height = height;

                JsBarcode(tempCanvas, text, {
                    format: type,
                    width: width / 200, // Scale appropriately
                    height: height - 40, // Leave space for margins
                    displayValue: showText,
                    lineColor: barColor,
                    background: bgColor,
                    margin: 20,
                    fontSize: Math.max(12, width / 40)
                });

                // Download as PNG or JPG
                const mimeType = this.currentFormat === 'jpg' ? 'image/jpeg' : 'image/png';
                const quality = this.currentFormat === 'jpg' ? 0.95 : undefined;
                
                tempCanvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.download = `barcode_${width}x${height}.${this.currentFormat}`;
                    link.href = url;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);

                    this.showNotification(`${this.currentFormat.toUpperCase()} barcode downloaded (${width}×${height})!`, 'success');
                }, mimeType, quality);
            }

            downloadCurrentBarcode() {
                // Get current canvas dimensions
                const canvas = document.getElementById('barcodeCanvas');
                const rect = canvas.getBoundingClientRect();
                this.downloadBarcode(Math.round(rect.width * 2), Math.round(rect.height * 2));
            }

            clearAll() {
                document.getElementById('barcodeText').value = '';
                this.hideBarcode();
                this.hideValidation();
                this.showNotification('Cleared! Enter text to generate new barcode.', 'success');
            }

            showNotification(message, type) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        // Global functions
        let barcodeGen;

        function generateBarcode() {
            barcodeGen.generateBarcode();
        }

        function downloadBarcode(width, height) {
            barcodeGen.downloadBarcode(width, height);
        }

        function downloadCurrentBarcode() {
            barcodeGen.downloadCurrentBarcode();
        }

        function clearAll() {
            barcodeGen.clearAll();
        }

        function setTemplate(template) {
            barcodeGen.setTemplate(template);
        }

        function setDownloadFormat(format) {
            barcodeGen.setDownloadFormat(format);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            barcodeGen = new BarcodeGenerator();
        });
    </script>
</body>
</html>
