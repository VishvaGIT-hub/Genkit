<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Word Converter Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e90ff 0%, #87ceeb 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #1e90ff, #4169e1);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .feature-notice {
            background: linear-gradient(45deg, #fff8e1, #fffbf0);
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .feature-notice h3 {
            color: #f57c00;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .feature-notice p {
            color: #bf8900;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .upload-section {
            margin-bottom: 30px;
        }

        .upload-area {
            border: 3px dashed #1e90ff;
            border-radius: 15px;
            padding: 50px;
            text-align: center;
            background: #f8f9ff;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: #4169e1;
            background: #e6f2ff;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(30, 144, 255, 0.2);
        }

        .upload-icon {
            font-size: 4rem;
            color: #1e90ff;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .upload-text {
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-subtext {
            color: #666;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        .file-requirements {
            background: #e6f2ff;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #1e90ff;
            margin: 15px 0;
        }

        .requirement-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: #333;
        }

        .requirement-item:last-child {
            margin-bottom: 0;
        }

        #fileInput {
            display: none;
        }

        .file-info {
            display: none;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e6f2ff;
        }

        .file-info h3 {
            color: #1e90ff;
            margin-bottom: 15px;
            font-size: 1.3rem;
            text-align: center;
        }

        .file-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .detail-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .detail-card .icon {
            font-size: 2rem;
            color: #1e90ff;
            margin-bottom: 10px;
        }

        .detail-card .value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .detail-card .label {
            font-size: 0.9rem;
            color: #666;
        }

        .processing-section {
            display: none;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid #e6f2ff;
        }

        .processing-steps {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            min-width: 120px;
        }

        .step-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            background: #ddd;
            transition: all 0.3s ease;
        }

        .step-icon.active {
            background: linear-gradient(45deg, #1e90ff, #4169e1);
            animation: pulse 1.5s infinite;
        }

        .step-icon.completed {
            background: #00b894;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .step-label {
            font-size: 0.9rem;
            color: #666;
            text-align: center;
        }

        .progress-container {
            background: #e6f2ff;
            border-radius: 25px;
            height: 12px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(45deg, #1e90ff, #4169e1);
            height: 100%;
            border-radius: 25px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            color: #1e90ff;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .preview-section {
            display: none;
            margin-bottom: 30px;
        }

        .preview-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .preview-header h3 {
            color: #1e90ff;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .content-preview {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid #e6f2ff;
            max-height: 400px;
            overflow-y: auto;
        }

        .extracted-text {
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .text-stats {
            background: #e6f7ff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-item .value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #1e90ff;
            margin-bottom: 5px;
        }

        .stat-item .label {
            font-size: 0.9rem;
            color: #666;
        }

        .action-buttons {
            display: none;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            min-width: 180px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #1e90ff, #4169e1);
            color: white;
            box-shadow: 0 5px 15px rgba(30, 144, 255, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #4169e1, #1e90ff);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(30, 144, 255, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #00b894, #00a085);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }

        .btn-success:hover {
            background: linear-gradient(45deg, #00a085, #00b894);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 184, 148, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e9ecef;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .message {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
            display: none;
            border-left: 5px solid;
        }

        .error-message {
            background: #ffe6e6;
            color: #d63031;
            border-left-color: #d63031;
        }

        .success-message {
            background: #e6ffe6;
            color: #00b894;
            border-left-color: #00b894;
        }

        .warning-message {
            background: #fff8e1;
            color: #f57c00;
            border-left-color: #f57c00;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 25px 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .main-content {
                padding: 25px 20px;
            }

            .upload-area {
                padding: 40px 20px;
            }

            .upload-icon {
                font-size: 3rem;
            }

            .upload-text {
                font-size: 1.2rem;
            }

            .file-details {
                grid-template-columns: 1fr;
            }

            .processing-steps {
                flex-direction: column;
                gap: 15px;
            }

            .process-step {
                flex-direction: row;
                justify-content: center;
                min-width: auto;
            }

            .text-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .action-buttons {
                flex-direction: column;
                align-items: stretch;
            }

            .btn {
                min-width: auto;
                padding: 12px 20px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .main-content {
                padding: 20px 15px;
            }

            .upload-area {
                padding: 30px 15px;
            }

            .file-info,
            .processing-section,
            .detail-card {
                padding: 20px 15px;
            }

            .text-stats {
                grid-template-columns: 1fr;
            }

            .content-preview {
                max-height: 300px;
            }

            .extracted-text {
                font-size: 0.9rem;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📄 PDF to Word Converter</h1>
            <p>Convert your PDF documents to editable Word format</p>
        </div>

        <div class="main-content">
            <!-- Feature Notice -->
            <div class="feature-notice">
                <h3>⚠️ Conversion Features & Limitations</h3>
                <p>This tool extracts text content from PDFs and converts it to Word format. Complex formatting, images, and tables may not be preserved. For best results, use PDFs with clear, selectable text.</p>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">📄</div>
                    <div class="upload-text">Drop your PDF file here or click to browse</div>
                    <div class="upload-subtext">Convert PDF documents to editable Word format</div>
                    
                    <div class="file-requirements">
                        <div class="requirement-item">
                            ✅ Supported format: PDF files only
                        </div>
                        <div class="requirement-item">
                            ✅ Maximum file size: 20MB
                        </div>
                        <div class="requirement-item">
                            ✅ Text-based PDFs work best
                        </div>
                        <div class="requirement-item">
                            ⚠️ Scanned PDFs may have limited accuracy
                        </div>
                    </div>
                </div>
                <input type="file" id="fileInput" accept=".pdf">
            </div>

            <!-- Messages -->
            <div class="message error-message" id="errorMessage"></div>
            <div class="message success-message" id="successMessage"></div>
            <div class="message warning-message" id="warningMessage"></div>

            <!-- File Info -->
            <div class="file-info" id="fileInfo">
                <h3>📋 PDF File Information</h3>
                <div class="file-details">
                    <div class="detail-card">
                        <div class="icon">📄</div>
                        <div class="value" id="fileName">-</div>
                        <div class="label">File Name</div>
                    </div>
                    <div class="detail-card">
                        <div class="icon">📏</div>
                        <div class="value" id="fileSize">-</div>
                        <div class="label">File Size</div>
                    </div>
                    <div class="detail-card">
                        <div class="icon">📚</div>
                        <div class="value" id="pageCount">-</div>
                        <div class="label">Pages</div>
                    </div>
                </div>
            </div>

            <!-- Processing Section -->
            <div class="processing-section" id="processingSection">
                <div class="processing-steps">
                    <div class="process-step">
                        <div class="step-icon" id="step1">1</div>
                        <div class="step-label">Reading PDF</div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon" id="step2">2</div>
                        <div class="step-label">Extracting Text</div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon" id="step3">3</div>
                        <div class="step-label">Creating Word</div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon" id="step4">4</div>
                        <div class="step-label">Finalizing</div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">Initializing conversion...</div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section" id="previewSection">
                <div class="preview-header">
                    <h3>👀 Extracted Content Preview</h3>
                    <p>Review the extracted text before downloading</p>
                </div>
                
                <div class="content-preview">
                    <div class="extracted-text" id="extractedText"></div>
                    <div class="text-stats">
                        <div class="stat-item">
                            <div class="value" id="characterCount">0</div>
                            <div class="label">Characters</div>
                        </div>
                        <div class="stat-item">
                            <div class="value" id="wordCount">0</div>
                            <div class="label">Words</div>
                        </div>
                        <div class="stat-item">
                            <div class="value" id="paragraphCount">0</div>
                            <div class="label">Paragraphs</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons" id="actionButtons">
                <button class="btn btn-primary" id="convertBtn">
                    🔄 Convert to Word
                </button>
                <button class="btn btn-success" id="downloadBtn" style="display: none;">
                    💾 Download Word File
                </button>
                <button class="btn btn-secondary" id="resetBtn">
                    🔄 Upload New PDF
                </button>
            </div>
        </div>
    </div>

    <script>
        // Set PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        class PDFToWordConverter {
            constructor() {
                this.uploadedFile = null;
                this.extractedText = '';
                this.pdfDoc = null;
                this.wordDoc = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                // Main elements
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileInfo = document.getElementById('fileInfo');
                this.processingSection = document.getElementById('processingSection');
                this.previewSection = document.getElementById('previewSection');
                this.actionButtons = document.getElementById('actionButtons');
                
                // Messages
                this.errorMessage = document.getElementById('errorMessage');
                this.successMessage = document.getElementById('successMessage');
                this.warningMessage = document.getElementById('warningMessage');
                
                // File info elements
                this.fileName = document.getElementById('fileName');
                this.fileSize = document.getElementById('fileSize');
                this.pageCount = document.getElementById('pageCount');
                
                // Processing elements
                this.step1 = document.getElementById('step1');
                this.step2 = document.getElementById('step2');
                this.step3 = document.getElementById('step3');
                this.step4 = document.getElementById('step4');
                this.progressBar = document.getElementById('progressBar');
                this.progressText = document.getElementById('progressText');
                
                // Preview elements
                this.extractedTextElement = document.getElementById('extractedText');
                this.characterCount = document.getElementById('characterCount');
                this.wordCount = document.getElementById('wordCount');
                this.paragraphCount = document.getElementById('paragraphCount');
                
                // Buttons
                this.convertBtn = document.getElementById('convertBtn');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.resetBtn = document.getElementById('resetBtn');
            }

            bindEvents() {
                // Upload events
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e.target.files[0]));
                
                // Drag and drop
                this.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.add('dragover');
                });
                
                this.uploadArea.addEventListener('dragleave', () => {
                    this.uploadArea.classList.remove('dragover');
                });
                
                this.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                    const file = e.dataTransfer.files[0];
                    if (file && file.type === 'application/pdf') {
                        this.handleFileSelect(file);
                    }
                });

                // Button events
                this.convertBtn.addEventListener('click', () => this.convertPDFToWord());
                this.downloadBtn.addEventListener('click', () => this.downloadWordFile());
                this.resetBtn.addEventListener('click', () => this.reset());
            }

            handleFileSelect(file) {
                if (!file) return;

                if (file.type !== 'application/pdf') {
                    this.showError('Please select a valid PDF file.');
                    return;
                }

                if (file.size > 20 * 1024 * 1024) { // 20MB limit
                    this.showError('File size too large. Please select a PDF under 20MB.');
                    return;
                }

                this.uploadedFile = file;
                this.loadPDFInfo();
            }

            async loadPDFInfo() {
                try {
                    const arrayBuffer = await this.uploadedFile.arrayBuffer();
                    this.pdfDoc = await pdfjsLib.getDocument(arrayBuffer).promise;
                    
                    this.displayFileInfo();
                    this.showFileInfo();
                    
                } catch (error) {
                    console.error('Error loading PDF:', error);
                    this.showError('Error reading PDF file. Please ensure it\'s a valid PDF document.');
                }
            }

            displayFileInfo() {
                this.fileName.textContent = this.uploadedFile.name;
                this.fileSize.textContent = this.formatFileSize(this.uploadedFile.size);
                this.pageCount.textContent = this.pdfDoc.numPages;
            }

            showFileInfo() {
                this.fileInfo.style.display = 'block';
                this.fileInfo.classList.add('fade-in');
                this.actionButtons.style.display = 'flex';
                this.actionButtons.classList.add('fade-in');
                this.hideMessages();
            }

            async convertPDFToWord() {
                if (!this.pdfDoc) {
                    this.showError('Please upload a PDF file first.');
                    return;
                }

                this.showProcessing();
                this.convertBtn.disabled = true;

                try {
                    // Step 1: Reading PDF
                    this.updateProgress(1, 10, 'Reading PDF document...');
                    await this.delay(500);

                    // Step 2: Extract text
                    this.updateProgress(2, 30, 'Extracting text content...');
                    await this.extractTextFromPDF();

                    // Step 3: Create Word document
                    this.updateProgress(3, 70, 'Creating Word document...');
                    await this.createWordDocument();

                    // Step 4: Finalize
                    this.updateProgress(4, 100, 'Conversion completed!');
                    await this.delay(500);

                    this.hideProcessing();
                    this.showPreview();
                    this.showSuccess('PDF successfully converted to Word format!');

                } catch (error) {
                    console.error('Conversion error:', error);
                    this.hideProcessing();
                    this.showError('Error during conversion. Please try with a different PDF file.');
                } finally {
                    this.convertBtn.disabled = false;
                }
            }

            async extractTextFromPDF() {
                let fullText = '';
                const numPages = this.pdfDoc.numPages;

                for (let i = 1; i <= numPages; i++) {
                    const page = await this.pdfDoc.getPage(i);
                    const textContent = await page.getTextContent();
                    
                    let pageText = '';
                    textContent.items.forEach(item => {
                        pageText += item.str + ' ';
                    });
                    
                    fullText += pageText.trim() + '\n\n';
                    
                    // Update progress for each page
                    const pageProgress = 30 + (i / numPages) * 40;
                    this.updateProgress(2, pageProgress, `Extracting text from page ${i}/${numPages}...`);
                    await this.delay(100);
                }

                this.extractedText = fullText.trim();
                
                if (!this.extractedText) {
                    throw new Error('No text could be extracted from the PDF. This might be a scanned document or contain only images.');
                }
            }

            async createWordDocument() {
                const { Document, Packer, Paragraph, TextRun } = docx;

                // Split text into paragraphs
                const paragraphs = this.extractedText.split('\n\n').filter(p => p.trim());

                // Create document with paragraphs
                const docParagraphs = paragraphs.map(text => 
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: text.trim(),
                                font: "Calibri",
                                size: 22 // 11pt
                            })
                        ],
                        spacing: {
                            after: 200 // Space after paragraph
                        }
                    })
                );

                // Create the document
                this.wordDoc = new Document({
                    sections: [{
                        properties: {},
                        children: docParagraphs
                    }]
                });

                await this.delay(500); // Simulate processing time
            }

            showPreview() {
                // Display extracted text
                this.extractedTextElement.textContent = this.extractedText;
                
                // Calculate statistics
                const characters = this.extractedText.length;
                const words = this.extractedText.trim().split(/\s+/).length;
                const paragraphs = this.extractedText.split('\n\n').filter(p => p.trim()).length;
                
                this.characterCount.textContent = characters.toLocaleString();
                this.wordCount.textContent = words.toLocaleString();
                this.paragraphCount.textContent = paragraphs.toLocaleString();
                
                // Show preview section
                this.previewSection.style.display = 'block';
                this.previewSection.classList.add('slide-up');
                this.downloadBtn.style.display = 'inline-flex';
            }

            async downloadWordFile() {
                if (!this.wordDoc) {
                    this.showError('No Word document to download. Please convert a PDF first.');
                    return;
                }

                try {
                    const blob = await Packer.toBlob(this.wordDoc);
                    const fileName = this.uploadedFile.name.replace('.pdf', '') + '_converted.docx';
                    
                    saveAs(blob, fileName);
                    this.showSuccess(`Word document downloaded as ${fileName}`);
                    
                } catch (error) {
                    console.error('Download error:', error);
                    this.showError('Error downloading Word file. Please try again.');
                }
            }

            showProcessing() {
                this.processingSection.style.display = 'block';
                this.processingSection.classList.add('slide-up');
                this.resetProcessingSteps();
            }

            hideProcessing() {
                this.processingSection.style.display = 'none';
            }

            resetProcessingSteps() {
                [this.step1, this.step2, this.step3, this.step4].forEach(step => {
                    step.classList.remove('active', 'completed');
                });
                this.progressBar.style.width = '0%';
            }

            updateProgress(currentStep, percentage, text) {
                // Update step indicators
                [this.step1, this.step2, this.step3, this.step4].forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    if (index + 1 < currentStep) {
                        step.classList.add('completed');
                    } else if (index + 1 === currentStep) {
                        step.classList.add('active');
                    }
                });

                // Update progress bar and text
                this.progressBar.style.width = percentage + '%';
                this.progressText.textContent = text;
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            showError(message) {
                this.hideMessages();
                this.errorMessage.textContent = message;
                this.errorMessage.style.display = 'block';
                setTimeout(() => this.hideMessages(), 8000);
            }

            showSuccess(message) {
                this.hideMessages();
                this.successMessage.textContent = message;
                this.successMessage.style.display = 'block';
                setTimeout(() => this.hideMessages(), 4000);
            }

            showWarning(message) {
                this.hideMessages();
                this.warningMessage.textContent = message;
                this.warningMessage.style.display = 'block';
                setTimeout(() => this.hideMessages(), 6000);
            }

            hideMessages() {
                this.errorMessage.style.display = 'none';
                this.successMessage.style.display = 'none';
                this.warningMessage.style.display = 'none';
            }

            reset() {
                this.uploadedFile = null;
                this.extractedText = '';
                this.pdfDoc = null;
                this.wordDoc = null;
                this.fileInput.value = '';
                
                // Hide sections
                this.fileInfo.style.display = 'none';
                this.processingSection.style.display = 'none';
                this.previewSection.style.display = 'none';
                this.actionButtons.style.display = 'none';
                this.downloadBtn.style.display = 'none';
                
                // Reset displays
                this.fileName.textContent = '-';
                this.fileSize.textContent = '-';
                this.pageCount.textContent = '-';
                this.extractedTextElement.textContent = '';
                
                this.hideMessages();
                this.convertBtn.disabled = false;
            }
        }

        // Initialize the converter when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new PDFToWordConverter();
        });
    </script>
</body>
</html>
